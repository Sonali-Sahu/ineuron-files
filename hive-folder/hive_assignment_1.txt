1. Download vechile sales data -> https://github.com/shashank-mishra219/Hive-Class/blob/main/sales_order_data.csv
Ans. 
abc@994915bf825e:~/workspace$ ls
array_data.csv  depart_data.csv  map_data.csv  README.md  sales_order_data.csv

2. Store raw data into hdfs location
Ans. 
abc@994915bf825e:~/workspace$ hadoop fs -put sales_order_data.csv /tmp
2023-02-26 16:21:50,225 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false

abc@994915bf825e:~/workspace$ hadoop fs -ls /tmp
Found 2 items
drwx-wx-wx   - abc supergroup          0 2023-02-26 13:43 /tmp/hive
-rw-r--r--   1 abc supergroup     357410 2023-02-26 16:21 /tmp/sales_order_data.csv

3. Create a internal hive table "sales_order_csv" which will store csv data sales_order_csv .. make sure to skip header row while creating table
Ans.

hive> create table sales_order_data_internal 
(
    ORDERNUMBER int,
    QUANTITYORDERED int,
    PRICEEACH float,
    ORDERLINENUMBER int,
    SALES float ,
    STATUS string,
    QTR_ID int,
    MONTH_ID int,
    YEAR_ID int,
    PRODUCTLINE string,
    MSRP int,
    PRODUCTCODE string,
    PHONE string,
    CITY string,
    STATE string,
    POSTALCODE string,
    COUNTRY string,
    TERRITORY string,
    CONTACTLASTNAME string,
    CONTACTFIRSTNAME string,
    DEALSIZE string
)
row format delimited
fields terminated by ','
tblproperties("skip.header.line.count"="1") ;

OK
Time taken: 0.119 seconds

4. Load data from hdfs path into "sales_order_csv" 
Ans. 
hive> load data  inpath "/tmp/sales_order_data.csv" into table sales_order_data_internal;
Loading data to table my_db.sales_order_data_internal
OK
Time taken: 0.414 seconds

hive> select ordernumber,quantityordered from sales_order_data_internal limit 2;
OK
ordernumber     quantityordered
10107              30
10121              34
Time taken: 0.169 seconds, Fetched: 2 row(s)


5. Create an internal hive table which will store data in ORC format "sales_order_orc"
Ans. 
hive> create table sales_order_data_internal_orc
(
    ORDERNUMBER int,
    QUANTITYORDERED int,
    PRICEEACH float,
    ORDERLINENUMBER int,
    SALES float ,
    STATUS string,
    QTR_ID int,
    MONTH_ID int,
    YEAR_ID int,
    PRODUCTLINE string,
    MSRP int,
    PRODUCTCODE string,
    PHONE string,
    CITY string,
    STATE string,
    POSTALCODE string,
    COUNTRY string,
    TERRITORY string,
    CONTACTLASTNAME string,
    CONTACTFIRSTNAME string,
    DEALSIZE string
)
stored as orc;
OK
Time taken: 0.094 seconds

6. Load data from "sales_order_csv" into "sales_order_orc"
Ans. from sales_order_data_internal insert overwrite table sales_order_data_internal_orc select *;


Perform below menioned queries on "sales_order_orc" table :

a. Calculatye total sales per year
b. Find a product for which maximum orders were placed
c. Calculate the total sales for each quarter
d. In which quarter sales was minimum
e. In which country sales was maximum and in which country sales was minimum
f. Calculate quartelry sales for each city
h. Find a month for each year in which maximum number of quantities were sold
